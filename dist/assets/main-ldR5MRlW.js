import{r,o as t,j as n,c as A,R as N}from"./index-DrIzMESR.js";function R(){const[s,d]=r.useState(0),[u,m]=r.useState(!1),[l,x]=r.useState({timerDuration:45,soundEnabled:!0}),[v,E]=r.useState(!1),c=r.useRef(null);r.useEffect(()=>((async()=>{await t.initialize()||(E(!0),console.log("Running in demo mode (no Overwolf)"));const a=t.getSettings();x(a),t.addEventListener("spike-planted",p),t.addEventListener("spike-defused",f),t.addEventListener("round-end",g),t.addEventListener("round-start",S)})(),()=>{t.removeEventListener("spike-planted",p),t.removeEventListener("spike-defused",f),t.removeEventListener("round-end",g),t.removeEventListener("round-start",S)}),[]),r.useEffect(()=>(u&&s>0?c.current=setInterval(()=>{d(e=>{const i=e-1;return i===10&&l.soundEnabled&&k(),i<=0?(o(),w(),0):i})},1e3):clearInterval(c.current),()=>clearInterval(c.current)),[u,s,l.soundEnabled]);const p=e=>{console.log("Spike planted event received:",e),h((e==null?void 0:e.duration)||l.timerDuration)},f=()=>{console.log("Spike defused event received"),o()},g=()=>{console.log("Round end event received"),o()},S=()=>{console.log("Round start event received"),o()},h=(e=l.timerDuration)=>{console.log("Starting timer with duration:",e),d(e),m(!0)},o=()=>{console.log("Stopping timer"),m(!1),d(0),clearInterval(c.current)},w=async()=>{try{await t.hideCurrentWindow()}catch(e){console.error("Failed to hide overlay:",e)}},T=()=>{v?h(45):t.simulateSpikePlant()},k=()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),i=e.createOscillator(),a=e.createGain();i.connect(a),a.connect(e.destination),i.frequency.setValueAtTime(800,e.currentTime),i.type="sine",a.gain.setValueAtTime(.3,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),i.start(e.currentTime),i.stop(e.currentTime+.5)}catch(e){console.log("Could not play warning sound:",e)}},y=e=>e.toString().padStart(2,"0"),b=()=>s<=5?"timer-display critical":s<=10?"timer-display warning":"timer-display",j=u&&s>0;return n.jsxs("div",{className:"timer-overlay",children:[j&&n.jsxs("div",{className:"timer-container fade-in",children:[n.jsx("div",{className:"controls",children:n.jsx("button",{className:"control-btn",onClick:o,children:"Ã—"})}),n.jsx("div",{className:"timer-title",children:"SPIKE PLANTED"}),n.jsx("div",{className:b(),children:y(s)}),n.jsx("div",{className:"timer-subtitle",children:"seconds remaining"})]}),v&&n.jsxs("div",{className:"demo-controls",children:[n.jsx("button",{className:"demo-btn",onClick:T,children:"Simulate Spike Plant"}),n.jsx("button",{className:"demo-btn",onClick:o,children:"Stop Timer"})]})]})}A.createRoot(document.getElementById("root")).render(n.jsx(N.StrictMode,{children:n.jsx(R,{})}));
